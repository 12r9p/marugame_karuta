## 🎯 字幕データ仕様書（タイムタグ方式）

### 1. データフォーマット

* テキスト中に `<秒数>` タグを埋め込み、**そのタイミングから先の文字を表示開始する**
* 秒数は音声の再生開始からの相対秒
* 最初の `<秒数>` までの部分は表示されない（常にタグの時間から出現）

#### 例

```
<0>a<0.1>b<0.3>c<0.4>d
```

| タイムスタンプ | 表示される文字      |
| ------- | ------------ |
| 0.0 秒   | （まだ何も表示しない）  |
| 0.0 秒   | `a` が表示される   |
| 0.1 秒   | `b` が追加表示される |
| 0.3 秒   | `c` が追加表示される |
| 0.4 秒   | `d` が追加表示される |

---

### 2. 仕様の詳細

1. **タグ書式**

   * `<秒数>` の形
   * 秒数は小数点可（例: `<1.25>`）
   * 負数は禁止

2. **解釈ルール**

   * 最初のタグの時刻になるまで文字は一切表示しない
   * タグを見つけるとその時点から後続の文字列を表示
   * 次のタグまでが同じ時刻で表示される文字列のかたまり

3. **複数文字まとめて表示**

   * タグ直後に複数文字ある場合、それらは同じタイミングで一度に表示
   * 例: `<1.0>こんにちは` → 1.0秒時点で「こんにちは」が一気に出る

4. **末尾**

   * テキスト末尾にタグがなくても問題なし（最後のタグ時刻で表示）

---

### 3. データ構造（実装者向け）

パース後は次のような配列に変換する：

```js
[
  { t: 0.0, text: "a" },
  { t: 0.1, text: "b" },
  { t: 0.3, text: "c" },
  { t: 0.4, text: "d" }
]
```

再生ループ中で `currentTime >= t` になったら `text` を追加表示。

---

### 4. 例外処理

* タグが昇順になっていない場合 → **昇順に並び替える**（または警告）
* タグが欠落している場合 → 直前のタイムスタンプを引き継ぐ
* 無効なタグ（数字以外） → 無視して表示しない or エラー扱い

---

### 5. UI での表示仕様

* 一度表示された文字は消えない（累積表示）
